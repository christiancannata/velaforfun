{% extends 'base.html.twig' %}

{% block title %}{{ categoria.nome }}{% endblock %}





{% block javascripts %}
    <script src="http://imagesloaded.desandro.com/imagesloaded.pkgd.min.js"></script>
    <script src="{{ asset('bundles/app/js/bootstrap-lightbox.min.js') }}"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/masonry/3.3.0/masonry.pkgd.min.js"></script>
    <script language="javascript">
        $(document).ready(function () {


            var offset = 8;
            var loading = false;
            $(window).scroll(function () {
                if ($(window).scrollTop() >= ($("#loadmoreajaxloader").height() - $(window).height()) ) {
                    if (loading == false) {
                        $('div#loadmoreajaxloader').show();
                        loading = true;
                        $.ajax({
                            url: "{{ categoria.permalink }}/json?offset=" + offset,
                            success: function (html) {
                                if (html) {
                                    $('div#loadmoreajaxloader').remove();
                                    $("#postswrapper").append(html);
                                } else {
                                    $('div#loadmoreajaxloader').html('<center>No more posts to show.</center>');
                                }
                                offset += 3;
                                loading = false;
                            }
                        });
                    }

                }
            });


        })
    </script>
{% endblock %}

{% block body %}

  <div class="row clearfix">
        <div class="col-md-8 column">
<div class="row clearfix">
    <div class="col-md-12 column">
    <div class="title">
               <h1 class="category-title">
               {{ categoria.nome }} - Ultime news
               </h1>
            </div>
        </div>
    </div>
            <div class="row clearfix">
                <div class="col-md-12 column">
            <div class="article main-article">
            {% if articoli|length > 0 and articoli[0] is defined %}

    <div class="content"
         style="background-image: url(/images/articoli/{{ articoli[0].immagine }})">

        <div class="content-title">
            <a href="/archivio/{{ categoria.permalink }}/{{ articoli[0].permalink }}"><h3>{{ articoli[0].titolo }}</h3>
            </a>

            <div class="divisore"></div>
            <div class="subtitle">
                {{ articoli[0].sottotitolo|raw|striptags }}
            </div>
        </div>

    </div>
{% endif %}
            </div>
                    </div></div>
        </div>
        <div class="col-md-4 column hidden-print" id="content-articolo">


               {% if articoli|length > 0 %}
    <div class="title" style="border-top:1px solid rgb(153, 153, 153);">
        {% if categoria.permalink == "ricette-antipasti" or  categoria.permalink == "ricette-primi" or categoria.permalink == "ricette-secondi" or categoria.permalink == "ricette-dolci" or categoria.permalink == "ricette-frutta" %}
        Altre ricette
        {% else %}
            Altri articoli
        {% endif %}
    </div>
    <div class="content">


        {% for articoloRel in articoli|slice(0,3) %}
            <a href="/archivio/{{ articoloRel.categoria.permalink }}/{{ articoloRel.permalink }}">
                <div class="latest-news hvr-underline-from-left">
                    <div class="content">
                        <h4>{{ articoloRel.titolo }}</h4>

                        <p>  {{ articoloRel.sottotitolo|slice(0, 70)|raw|striptags }}...</p>
                    </div>
                    <div class="arrow">
                        <span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
                    </div>
                </div>
            </a>
        {% endfor %}

    </div>
{% endif %}

            {% if articolo.linkCorrelato is defined and articolo.linkCorrelato!="" %}

    <a href="{{ articolo.linkCorrelato }}">
        <div class="arrow_box">
            {% if articolo.immagineCorrelataArticolo is defined %}
                <div class="foto">
                    <div class="center-cropped"
                         style="height: 230px;background-image: url('/images/articoli/{{ articolo.immagineCorrelataArticolo }}');">
                    </div>
                </div>
            {% endif %}
            <div class="content">
                <h4>{{ articolo.titoloCorrelato }}</h4>

                <p>  {{ articolo.testoCorrelato|striptags }}</p>
            </div>

        </div>

    </a>


{% endif %}



        </div>
    </div>

    <div class="row clearfix">
        <div class="col-md-12 column">
            <div class="divisore-big"></div>
        </div>
    </div>
    <div class="row clearfix">
            <div id="postswrapper">

        {% for articolo in articoli|slice(4,3) %}
    <div class="col-md-4 column">
        <a href="/archivio/{{ articolo.categoria.permalink }}/{{ articolo.permalink }}">
            <div class="box-sub hvr-underline-from-left">
                <div class="foto">
                <div class="category">
                        <a href="/archivio/{{ articolo.categoria.permalink }}"><span
                                    style="background:{{ articolo.categoria.getColore() }}">{{ articolo.categoria.nome|capitalize }}</span>
                            <span style="background:{{ articolo.categoria.getColore() }};   padding-left: 11px;
                                    padding-right: 11px;font-weight: bold;">+</span>
                        </a>
                    </div>
                    <div class="center-cropped"
                         style="background-image: url('/images/articoli/{{ articolo.immagine }}');">
                    </div>
                </div>
                <h4>{{ articolo.titolo }}</h4>

                <p> {{ articolo.sottotitolo|slice(0, 140)|raw|striptags }}...</p>
            </div>
        </a>

    </div>

{% endfor %}
 <div id="loadmoreajaxloader" style="display:none;">
                <center><i class="fa fa-spinner fa-2x fa-spin "></i></center>
            </div>
</div>
</div>


{% if articoli[1] is defined %}
    <div class="row clearfix">
        <div class="col-md-12 column">
            <div class="divisore-big"></div>
        </div>
    </div>
{% endif %}
    </div>


        <!-- fine contenuto -->

    </div>

{% endblock %}



